{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/rd96/OneDrive/Desktop/Social Media Clone/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/rd96/OneDrive/Desktop/Social Media Clone/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/rd96/OneDrive/Desktop/Social Media Clone/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import\"./Share.scss\";import{useContext,useState}from\"react\";import{AuthContext}from\"../../context/authContext\";import{useMutation,useQueryClient}from\"@tanstack/react-query\";import{makeRequest}from\"../../axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Share=function Share(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),file=_useState2[0],setFile=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),desc=_useState4[0],setDesc=_useState4[1];//Upload function\nvar upload=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var formData,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;formData=new FormData();formData.append(\"file\",file);_context.next=5;return makeRequest.post(\"/upload\",formData);case 5:res=_context.sent;return _context.abrupt(\"return\",res.data);case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 12:case\"end\":return _context.stop();}},_callee,null,[[0,9]]);}));return function upload(){return _ref.apply(this,arguments);};}();var _useContext=useContext(AuthContext),currentUser=_useContext.currentUser;var queryClient=useQueryClient();//Code taken from: https://www.npmjs.com/package/multer\nvar mutation=useMutation(function(newPost){return makeRequest.post(\"/posts\",newPost);},{onSuccess:function onSuccess(){queryClient.invalidateQueries([\"posts\"]);}});var handleClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){var imgUrl;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:e.preventDefault();imgUrl=\"\";if(!file){_context2.next=6;break;}_context2.next=5;return upload();case 5:imgUrl=_context2.sent;case 6:mutation.mutate({desc:desc,img:imgUrl});setDesc(\"\");setFile(null);case 9:case\"end\":return _context2.stop();}},_callee2);}));return function handleClick(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"share\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"top\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"left\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/upload/\"+currentUser.profilePic,alt:\"\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"What's on your mind \".concat(currentUser.name,\"?\"),onChange:function onChange(e){return setDesc(e.target.value);},value:desc})]}),/*#__PURE__*/_jsx(\"div\",{className:\"right\",children:file&&/*#__PURE__*/_jsx(\"img\",{className:\"file\",alt:\"\",src:URL.createObjectURL(file)})})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"bottom\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"left\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"file\",style:{display:\"none\"},onChange:function onChange(e){return setFile(e.target.files[0]);}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"file\",children:/*#__PURE__*/_jsx(\"div\",{className:\"item\",children:/*#__PURE__*/_jsx(\"span\",{children:\"Add Image\"})})})]})})]})});};export default Share;","map":{"version":3,"names":["useContext","useState","AuthContext","useMutation","useQueryClient","makeRequest","jsx","_jsx","jsxs","_jsxs","Share","_useState","_useState2","_slicedToArray","file","setFile","_useState3","_useState4","desc","setDesc","upload","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","formData","res","wrap","_callee$","_context","prev","next","FormData","append","post","sent","abrupt","data","t0","console","log","stop","apply","arguments","_useContext","currentUser","queryClient","mutation","newPost","onSuccess","invalidateQueries","handleClick","_ref2","_callee2","e","imgUrl","_callee2$","_context2","preventDefault","mutate","img","_x","className","children","src","profilePic","alt","type","placeholder","concat","name","onChange","target","value","URL","createObjectURL","id","style","display","files","htmlFor"],"sources":["C:/Users/rd96/OneDrive/Desktop/Social Media Clone/client/src/components/Share/Share.jsx"],"sourcesContent":["import \"./Share.scss\";\r\nimport { useContext, useState } from \"react\";\r\nimport { AuthContext } from \"../../context/authContext\";\r\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { makeRequest } from \"../../axios\";\r\n\r\nconst Share = () => {\r\n  const [file, setFile] = useState(null);\r\n  const [desc, setDesc] = useState(\"\");\r\n\r\n  //Upload function\r\n  const upload = async () => {\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append(\"file\", file);\r\n      const res = await makeRequest.post(\"/upload\", formData);\r\n      return res.data;\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  const { currentUser } = useContext(AuthContext);\r\n\r\n  const queryClient = useQueryClient();\r\n\r\n  //Code taken from: https://www.npmjs.com/package/multer\r\n  const mutation = useMutation(\r\n    (newPost) => {\r\n      return makeRequest.post(\"/posts\", newPost);\r\n    },\r\n    {\r\n      onSuccess: () => {\r\n        queryClient.invalidateQueries([\"posts\"]);\r\n      },\r\n    }\r\n  );\r\n\r\n  const handleClick = async (e) => {\r\n    e.preventDefault();\r\n    let imgUrl = \"\";\r\n    if (file) imgUrl = await upload();\r\n    mutation.mutate({ desc, img: imgUrl });\r\n    setDesc(\"\");\r\n    setFile(null);\r\n  };\r\n\r\n  return (\r\n    <div className=\"share\">\r\n      <div className=\"container\">\r\n        <div className=\"top\">\r\n          <div className=\"left\">\r\n            <img src={\"/upload/\" + currentUser.profilePic} alt=\"\" />\r\n            <input\r\n              type=\"text\"\r\n              placeholder={`What's on your mind ${currentUser.name}?`}\r\n              onChange={(e) => setDesc(e.target.value)}\r\n              value={desc}\r\n            />\r\n          </div>\r\n          <div className=\"right\">\r\n            {file && (\r\n              <img className=\"file\" alt=\"\" src={URL.createObjectURL(file)} />\r\n            )}\r\n          </div>\r\n        </div>\r\n        <hr />\r\n        <div className=\"bottom\">\r\n          <div className=\"left\">\r\n            <input\r\n              type=\"file\"\r\n              id=\"file\"\r\n              style={{ display: \"none\" }}\r\n              onChange={(e) => setFile(e.target.files[0])}\r\n            />\r\n            <label htmlFor=\"file\">\r\n              <div className=\"item\">\r\n                {/* <img src={Image} alt=\"\" /> */}\r\n                <span>Add Image</span>\r\n              </div>\r\n            </label>\r\n            </div>\r\n            </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Share;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}